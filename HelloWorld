public static async Task WriteCsvAsync(string outputFilePath, IEnumerable<dynamic> records)
{
    var config = new CsvConfiguration(CultureInfo.InvariantCulture)
    {
        IgnoreBlankLines = true
    };

    using var writer = new StreamWriter(outputFilePath);
    using var csvWriter = new CsvWriter(writer, config);

    var recordList = records.Select(record => (IDictionary<string, object>)record).ToList();
    foreach (var record in recordList)
    {
        foreach (var kvp in record)
        {
            csvWriter.WriteField(kvp.Value);
        }
        await csvWriter.NextRecordAsync();
    }
}

public static async Task WriteCsvAsync(Stream outputStream, IEnumerable<dynamic> records)
{
    var config = new CsvConfiguration(CultureInfo.InvariantCulture)
    {
        IgnoreBlankLines = true
    };

    using var writer = new StreamWriter(outputStream, leaveOpen: true);
    using var csvWriter = new CsvWriter(writer, config);

    var recordList = records.Select(record => (IDictionary<string, object>)record).ToList();
    foreach (var record in recordList)
    {
        foreach (var kvp in record)
        {
            csvWriter.WriteField(kvp.Value);
        }
        await csvWriter.NextRecordAsync();
    }
}
