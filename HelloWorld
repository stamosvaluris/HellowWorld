public static class ZipHelper
{
    public static List<string> ExtractLastImportedZipFile(string folderPath)
    {
        // Get the last imported .zip file in the given directory
        var lastImportedZipFile = new DirectoryInfo(folderPath)
            .GetFiles("*.zip")
            .OrderByDescending(f => f.LastWriteTime)
            .FirstOrDefault();

        if (lastImportedZipFile == null)
        {
            throw new FileNotFoundException("No .zip files found in the specified directory.");
        }

        // Path to extract the zip file (in the same directory as the .zip file)
        string extractedFolderPath = Path.Combine(folderPath, Path.GetFileNameWithoutExtension(lastImportedZipFile.Name) + "_extracted");

        // Ensure the extract directory exists
        if (!Directory.Exists(extractedFolderPath))
        {
            Directory.CreateDirectory(extractedFolderPath);
        }

        // Extract the zip file
        ZipFile.ExtractToDirectory(lastImportedZipFile.FullName, extractedFolderPath);

        // Get the paths of the extracted files
        var extractedFilePaths = Directory.GetFiles(extractedFolderPath, "*", SearchOption.AllDirectories).ToList();

        return extractedFilePaths;
    }
}
